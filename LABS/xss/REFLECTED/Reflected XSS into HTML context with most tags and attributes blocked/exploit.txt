
https://portswigger.net/web-security/cross-site-scripting/contexts/lab-html-context-with-most-tags-and-attributes-blocked
This lab contains a reflected XSS vulnerability in the search functionality but uses a web application firewall (WAF) to protect against common XSS vectors.

To solve the lab, perform a cross-site scripting attack that bypasses the WAF and calls the print() function.


1) try to inject <b> into the search input
    we receive the message "Tag is not allowed"

2) maybe there are some allowed tags, so fuzz the b into the <b> with the tags we can found here: https://portswigger.net/web-security/cross-site-scripting/cheat-sheet

    we can see that the <body> and <custom tag> are allowed

    BUT focus on <body> that is standard one  (custom tag can allow us to create a new tag)

3) try to see that some attributes are allowed, fuzzing them with the attributes/events of: https://portswigger.net/web-security/cross-site-scripting/cheat-sheet
    <body onload=alert()>

    but we obtain Attribute not allowed

    onbeforetoggle
    onscrolled
    onresize

    are allowed, so try to create an exploit with a body and onresize
4) try to see if it works and inject
    <body onresize=print()> 

    it works, so create the exploit

5) create an iframe that includes the vulnerable website and resizes it:
    <iframe src="https://YOUR-LAB-ID.web-security-academy.net/?search=<body onresize=print()> " onload=this.style.width='100px'>

    the onload will resize the frame

