https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-dom-xss-stored

This lab demonstrates a stored DOM vulnerability in the blog comment functionality. To solve this lab, exploit this vulnerability to call the alert() function.



1) visit a post and see that the comments are appended to the page using a javascript function
     <script>loadComments('/post/comment')</script>

    in addition we can see that it is taken by a js file 
    
    <script src='/resources/js/loadCommentsWithVulnerableEscapeHtml.js'></script>
    
2) so visit /resources/js/loadCommentsWithVulnerableEscapeHtml.js   to see the js file
    we can easily see that the body and the author of a comment are created and modified using the innerHtml so we could inject a <img> tag

    but we have a problem because < and > are escaped using a function of js 
    html.replace('<', '&lt;').replace('>', '&gt;');

    BUT .replace takes only the first occurency of the char so we can craft this payload

    <> <img src=1 onerror=alert()>


4) inject it in the body of a new comment and see that the alert is triggered
