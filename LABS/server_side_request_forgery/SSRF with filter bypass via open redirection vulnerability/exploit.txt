https://portswigger.net/web-security/ssrf/lab-ssrf-filter-bypass-via-open-redirection


This lab has a stock check feature which fetches data from an internal system.

To solve the lab, change the stock check URL to access the admin interface at http://192.168.0.12:8080/admin and delete the user carlos.

The stock checker has been restricted to only access the local application, so you will need to find an open redirect affecting the application first.


1) in the product page we can see that there is a link to the next product and if we click on it we perform a request to 
    /product/nextProduct?currentProductId=2&path=/product?productId=3

    so if we try to change path=www.google.it we can see that there is an open redirect to it 

2) we know that http://192.168.0.12:8080/admin is the admin panel and is accessible if we are administrators or if we use a loopback interface

so try to use:
    /product/nextProduct?currentProductId=2&path=http://192.168.0.12:8080/admin

    we obtain the admin page

3) delete carlos with
    /product/nextProduct?currentProductId=2&path=http://192.168.0.12:8080/admin/delete?username=carlos
