https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-exploiting-ruby-deserialization-using-a-documented-gadget-chain



This lab uses a serialization-based session mechanism and the Ruby on Rails framework. There are documented exploits that enable remote code execution via a gadget chain in this framework.

To solve the lab, find a documented exploit and adapt it to create a malicious serialized object containing a remote code execution payload. Then, pass this object into the website to delete the morale.txt file from Carlos's home directory.

You can log in to your own account using the following credentials: wiener:peter




1) Log in as wiener:peter and notice that the session cookie contains a serialized ("marshaled") Ruby object

2) Browse the web to find the Universal Deserialisation Gadget for Ruby 2.x-3.x by vakzz on devcraft.io. 
    a) Change the command that should be executed from id to rm /home/carlos/morale.txt.
    b) Replace the final two lines with puts Base64.encode64(payload)

3) Run the script and copy the resulting Base64-encoded object
    ruby script.rb

