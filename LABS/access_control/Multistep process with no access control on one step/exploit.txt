https://portswigger.net/web-security/access-control/lab-multi-step-process-with-no-access-control-on-one-step

This lab has an admin panel with a flawed multi-step process for changing a user's role. You can familiarize yourself with the admin panel by logging in using the credentials administrator:admin.

To solve the lab, log in using the credentials wiener:peter and exploit the flawed access controls to promote yourself to become an administrator.


1) log in as administrator:admin and change the role of carlos, upgrading it 
2) here we can see that the site requests the confirmation and to change the role we do 2 POST request to /admin-roles.
    the first one contains in the body: username=carlos&action=upgrade
    the second one contains in the body: action=upgrade&confirmed=true&username=carlos

3) log in as wiener in an incognito tab and copy the session cookie

4) go back to administrator:admin and change the role of carlos with the interceptor, on the confirmation request change the session cookie with th eone of wiener and the username  with wiener

    
