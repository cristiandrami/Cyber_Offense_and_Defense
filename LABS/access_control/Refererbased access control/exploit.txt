https://portswigger.net/web-security/access-control/lab-referer-based-access-control

This lab controls access to certain admin functionality based on the Referer header. You can familiarize yourself with the admin panel by logging in using the credentials administrator:admin.

To solve the lab, log in using the credentials wiener:peter and exploit the flawed access controls to promote yourself to become an administrator.

1) access as administrator:admin to understang how role changing works

2) we can see that the role changing is done with a GET request to /admin-roles?username=carlos&action=upgrade
    but important thing is that in the request we can see:
    
    Referer: https://0a12000004fe72d280519e48008000a2.web-security-academy.net/admin


3) logouot and login as wiener:peter
    perform a GET request to /admin-roles?username=wiener&action=upgrade adding in the body
    
    Referer: https://0a12000004fe72d280519e48008000a2.web-security-academy.net/admin


4) the validation is done on the refere header, if the request becomes from /admin then the user is an adminstrator WRONG thing

5) game is done
