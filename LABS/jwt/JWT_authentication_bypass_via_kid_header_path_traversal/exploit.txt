https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-kid-header-path-traversal

This lab uses a JWT-based mechanism for handling sessions. In order to verify the signature, the server uses the kid parameter in JWT header to fetch the relevant key from its filesystem.

To solve the lab, forge a JWT that gives you access to the admin panel at /admin, then delete the user carlos.

You can log in to your own account using the following credentials: wiener:peter




1) using burp, install JWT editor from extensions
2) go to JWT editor panel and create New Symmetric key and click on generate
3) change k parameter to "AA=="
    AA== is null byte encoded in base64
4) perform the login with wiener:peter
5) go to /my-account and send it to the repeter
6) from the repeter go to JSON web token section
7) change sub from wiener to administrator
8) change kid to "../../../../dev/null"
9) click on bottom on "sign" and use the key generated before
10) copy the new token and paste it in session cookie in the browser
11) go to /admin and delete carlos


It works because the server will use ../../../../dev/null to sign the token but it returns a null byte that is equal to the one we used before
