https://portswigger.net/web-security/jwt/lab-jwt-authentication-bypass-via-jwk-header-injection

This lab uses a JWT-based mechanism for handling sessions. The server supports the jwk parameter in the JWT header. This is sometimes used to embed the correct verification key directly in the token. However, it fails to check whether the provided key came from a trusted source.

To solve the lab, modify and sign a JWT that gives you access to the admin panel at /admin, then delete the user carlos.

You can log in to your own account using the following credentials: wiener:peter






1) using burp, install JWT editor from extensions
2) go to JWT editor panel and create New RSA key and click for JWK
3) perform the login with wiener:peter
4) go to /my-account and send it to the repeter
5) from the repeter go to JSON web token section
6) change sub from wiener to administrator
7) click on bottom on "attack" and use the embended JWK and choose the key generated before
8) copy the new token and paste it in session cookie in the browser
9) go to /admin and delete carlos

NOTE: this works because the server uses the key contained in the jkw section of the token that is controlled by us
